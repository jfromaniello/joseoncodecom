--- 
layout: post
title: Using convention to resolve sequence names
tags: []

status: publish
type: post
published: true
meta: 
  blogger_permalink: /2010/12/using-convention-to-resolve-sequence.html
  blogger_author: "Jos\xC3\xA9http://www.blogger.com/profile/00939999997597980426noreply@blogger.com"
  blogger_blog: jfromaniello.blogspot.com
  blogger_images: "1"
  dsq_thread_id: "420239354"
---
<p>I’m currently working in a project with a legacy database. The database use a convention, where every table has his own identifier (one-column) and it must be generated by a sequence.</p>  <p>The name of the sequence follows a convention, first 26 characters of the Table name + the subfix “seq”. For instance, the sequence for the table Nationality is NATIONALITY_SEQ.</p>  <p>I take advantage of the convention as follows:</p>  <ul>   <li>I’ve mapped everything as “native”. </li>    <li>I wrote a new id generator as follows: </li> </ul>  <pre class="code"><span style="color: blue">public class </span><span style="color: #2b91af">SequenceByConvention </span>: <span style="color: #2b91af">SequenceGenerator
</span>{
    <span style="color: blue">public override void </span>Configure(<span style="color: #2b91af">IType </span>type, <span style="color: #2b91af">IDictionary</span>&lt;<span style="color: blue">string</span>, <span style="color: blue">string</span>&gt; parms, <span style="color: #2b91af">Dialect </span>dialect)
    {
        parms[<span style="color: #a31515">&quot;sequence&quot;</span>] = GetSequenceNameFromTableName(parms[<span style="color: #a31515">&quot;target_table&quot;</span>]);
        <span style="color: blue">base</span>.Configure(type, parms, dialect);
    }
    <span style="color: blue">private static string </span>GetSequenceNameFromTableName(<span style="color: blue">string </span>tableName)
    {
        <span style="color: blue">return </span>tableName.Substring(0, <span style="color: #2b91af">Math</span>.Min(26, tableName.Length)) + <span style="color: #a31515">&quot;_SEQ&quot;</span>;
    }
}</pre>

<ul>
  <li>And finally this is the dialect for this project: </li>
</ul>

<pre class="code"><span style="color: blue">public class </span><span style="color: #2b91af">MyDialect </span>: <span style="color: #2b91af">Oracle10gDialect
</span>{
    <span style="color: blue">public override </span>System.<span style="color: #2b91af">Type </span>NativeIdentifierGeneratorClass
    {
        <span style="color: blue">get </span>{ <span style="color: blue">return typeof </span>(<span style="color: #2b91af">SequenceByConvention</span>); }
    }
}</pre>  <div class="blogger-post-footer">http://feeds.feedburner.com/JoseFRomaniello<img width='1' height='1' src='http://joseoncode.com/wp-content/uploads/images/2935908889399243312-3816097961780090763' alt='' /></div>
